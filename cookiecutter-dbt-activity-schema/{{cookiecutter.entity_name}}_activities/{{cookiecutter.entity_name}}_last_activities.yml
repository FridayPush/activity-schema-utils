version: 2

models:
  - name: {{cookiecutter.entity_name}}_last_activities
    description: Bookmarks for the latest activities of {{cookiecutter.entity_name}}s. This is used in incremental updates of `{{cookiecutter.entity_name}}_activities` to a) increment the activity_occurrence of new activities to be added to the model and b) update the activity_repeated_at of the last activity with the first ts from the newly downloaded activities.

    tests:

      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - customer
            - activity

    columns:

      - name: last_activity_id
        description: Id for the latest activity.

      - name: ts
        description: Timestamp for when the latest activity occurred.

      - name: customer
        description: Identifier for {{cookiecutter.entity_name}}.
        tests:
          - not_null

      - name: activity
        description: Name of the {{cookiecutter.entity_name}} activity.
        tests:
          - not_null
         
      - name: anonymous_customer_id
        description: Unique identifier for an anonymous {{cookiecutter.entity_name}} (ex. 'segment_abfb8a').
        
      - name: feature_1
        description: Activity-specific feature 1, see `{{cookiecutter.entity_name}}_activity_dictionary` for more details.

      - name: feature_2
        description: Activity-specific feature 2, see `{{cookiecutter.entity_name}}_activity_dictionary` for more details.

      - name: feature_3
        description: Activity-specific feature 3, see `{{cookiecutter.entity_name}}_activity_dictionary` for more details.

      - name: revenue_impact
        description: Revenue or cost associated with the latest activity

      - name: link
        description: URL associated with the latest activity.

      - name: activity_occurrence
        description: How many times this activity has happened for the {{cookiecutter.entity_name}}.

      - name: _activity_source
        description: Version identifier for the transformation script that created this activity.